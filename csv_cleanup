import pandas as pd

# original
raw_path = '/mnt/c/coding_projects/conduit/dynamicconstr/priced_ceiling_construction.csv'

# Load it without a header row – we’ll name the cols manually
df = pd.read_csv(raw_path, header=None)

# total number of columns in the file
n_cols = df.shape[1]

real_cols = [
    "Ceiling type",
    "Deck construction",
    "Roofing material",
    "Roof color",
    "Insulation",
    "R-value",
    "Extended Construction Numbers",
    "Look-Up Construction Number",
    "Total Price"
]

# Check if there are any extra junk cols
n_unused = n_cols - len(real_cols)

# If it's missing expected cols, prob something's wrong
if n_unused < 0:
    raise ValueError(f"CSV has fewer columns ({n_cols}) than expected 9. Something’s off...")

unused_cols = [f"unused{i+1}" for i in range(n_unused)]

df.columns = real_cols + unused_cols

# Drop all the extra columns
df = df.drop(columns=unused_cols)

# strip out white space from every col we care abt
for col in real_cols:
    df[col] = df[col].astype(str).str.strip()

# Save the cleaned version 
cleaned_path = '/mnt/c/coding_projects/conduit/dynamicconstr/ceiling_construction_cleaned.csv'
df.to_csv(cleaned_path, index=False)

print(f"Cleaned CSV saved to {cleaned_path} (dropped {n_unused} unused columns)")
